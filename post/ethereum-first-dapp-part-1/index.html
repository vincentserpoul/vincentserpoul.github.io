<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" prefix="og: http://ogp.me/ns#" xmlns:og="http://ogp.me/ns#"><!--<![endif]-->

    <head>
                <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content="Ethereum first dapp - part 1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="author" content="">
        <meta name="keywords" content="awesome, definitely">
	
        <meta property="og:site_name" content="VS tech corner">
        <meta property="og:title" content="VS tech corner">
        <meta property="og:url" content="https://vincentserpoul.github.io/post/ethereum-first-dapp-part-1/">
        <meta property="og:description" content="">
    
        <meta property="og:type" content="article" />
        <meta property="og:article:author" content="" />
        <meta property="og:article:published_time" content="2016-08-08T15:00:27&#43;08:00" />
    
        <meta name="generator" content="Hugo 0.16" />
        <title>Ethereum first dapp - part 1 &middot; VS tech corner </title>
        <link rel="canonical" href="https://vincentserpoul.github.io/" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="">
        <link rel="stylesheet" type='text/css' href="https://vincentserpoul.github.io/css/main.css"/>
        <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300|Montserrat:700' rel='stylesheet' type='text/css'>
        <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
        <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    </head>

<body>
<!--[if lt IE 7]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chrome/â€Ž">install Google Chrome</a> to experience this site.</p><![endif]-->

    <header id="site-header">
        <div class="container">
            <a href="https://vincentserpoul.github.io/" alt="VS tech corner"><h1 class="blog-title heading">VS tech corner</h1></a>
            <p class="blog-description"></p>
        </div>
    </header>
<main class="content" role="main">
	<div class="container">
		<article class="post">
	<header class="post-header">
        <h3 class="p-post-title">Ethereum first dapp - part 1</h3>
    </header>

    <section class="post-content">
        

<h1 id="contracts">Contracts</h1>

<h2 id="prepare-your-folder-for-your-dapp">Prepare your folder for your dapp</h2>

<pre><code>mkdir dapp
</code></pre>

<p>inside this folder, we&rsquo;ll create one folder for truffle, one for geth.</p>

<pre><code>cd dapp
mkdir truffle geth
</code></pre>

<p>inside the geth folder, simply put the customGenesis block you can find in the ethereum-dev-environment blog post.</p>

<p>We are going to use two Ethereum clients, one for tests and devs, testrpc and one for a more real interaction, geth.</p>

<p>Let&rsquo;s install truffle and testrpc</p>

<pre><code>npm install ethereumjs-testrpc truffle
</code></pre>

<h2 id="truffle">Truffle</h2>

<p>Truffle is a-m-a-z-i-n-g for contract development. It will allow you to unit test the contracts and compile them into usable javascript objects usable in web3! Just what we needed!</p>

<p>First, init truffle scaffolding (I don&rsquo;t like -g install XD, so bear with my node_modules folder).</p>

<pre><code>node_modules/truffle/cli.js init
</code></pre>

<p>This will create different folders. You can have a look at <a href="http://truffle.readthedocs.io/">http://truffle.readthedocs.io/</a> to have more details.</p>

<h2 id="testrpc">Testrpc</h2>

<p>Let&rsquo;s launch the ethereumjs-testrpc</p>

<pre><code>node_modules/ethereumjs-testrpc/bin/testrpc
</code></pre>

<p>You will see it will create a new chain, in memory and create 10 new accounts for you to test.</p>

<h2 id="standard-token-contracts">Standard token contracts</h2>

<p>Don&rsquo;t try to reinvent the wheel, Consensys has given standard contracts to issue your own token.
Have a look here: <a href="https://github.com/ConsenSys/Tokens">https://github.com/ConsenSys/Tokens</a></p>

<p>Just copy to your contract folder:</p>

<ul>
<li>Tokens/Token_Contracts/contracts/HumanStandardToken.sol</li>
<li>Tokens/Token_Contracts/contracts/StandardToken.sol</li>
<li>Tokens/Token_Contracts/contracts/Token.sol</li>
</ul>

<h2 id="migrate">Migrate</h2>

<p>In order to compile and deploy your contracts in the rpc node you configured in truffle.js, you need to launch the following command:</p>

<pre><code>node_modules/truffle/cli.js migrate
</code></pre>

<p>If your code compiles, it will create javascript objects for each of your contract in the folder build/contracts.</p>

<h2 id="testing">Testing</h2>

<p>Here is an example of tests on HumanStandardToken (ES6)</p>

<pre><code>const it = require('mocha').it;
const assert = require('chai').assert;

contract('HumanStandardToken', (accounts) =&gt; {
  it('should put 1000000 rians in the first account', () =&gt; {
    const rians = HumanStandardToken.deployed();
    const initSupply = 1000000;

    return rians.balanceOf(accounts[0])
      .then(balance =&gt; assert.equal(
          balance.valueOf(), initSupply,
          `${initSupply} rians weren't in the first account`
        )
      );
  });

  it('should transfer rians to another user', () =&gt; {
    const rians = HumanStandardToken.deployed();

    return rians.transfer(accounts[1], 100, { from: accounts[0] })
      .then(
        () =&gt; rians.balanceOf(accounts[1])
      )
      .then(balance =&gt; assert.equal(
          balance.valueOf(), 100,
          `${accounts[1]} didn't was not transfered 100 rians but ${balance.valueOf()}`
        )
      );
  });
});
</code></pre>

<ul>
<li>/ ! \ *
I was stuck for hours because of the way contract functions can be called.
There are two types of actions on the Ethereum blockchain. Action which change the contract states (like transfer funds for example), and the one which don&rsquo;t (like get balance, for example).
In truffle, you call the latter with a &ldquo;call&rdquo; on the contract object, whereas the former doesn&rsquo;t need it&hellip; Confusing, isn&rsquo;t it?
I found out later that there are constant functions in solidity, which basically mean functions that don&rsquo;t change the contract state. When you specify these functions in you contract definition as &ldquo;constant&rdquo;, then, truffle doesn&rsquo;t need the call&hellip; Problem solved, everything now looks uniform.</li>
</ul>

    </section>

    <hr>

    <footer class="post-footer">
        <section class="f-1">
            

            <p class="f-post-time"><time datetime="2016-08-08T15:00:27&#43;08:00">August 8, 2016</time></p>
        </section>

        <section class="f-2">
            <section class="share">
                <span>Share:
                <a class="icon-twitter" href="http://twitter.com/share?text=Ethereum%20first%20dapp%20-%20part%201&url=https%3a%2f%2fvincentserpoul.github.io%2fpost%2fethereum-first-dapp-part-1%2f"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fvincentserpoul.github.io%2fpost%2fethereum-first-dapp-part-1%2f"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https%3a%2f%2fvincentserpoul.github.io%2fpost%2fethereum-first-dapp-part-1%2f"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="fa fa-google-plus"></i>
                </a>
                </span>
            </section>

            
            	<span class="f-post-tags"><i class="fa fa-tag"></i>
            	ethereum, dapp, development
            	</span>
            
        </section>
    </footer>

    <div id="disqus_thread"></div>
<script>
var disqus_config = function () {
    this.page.url = "https://vincentserpoul.github.io/post/ethereum-first-dapp-part-1/";  
    this.page.identifier = "https://vincentserpoul.github.io/post/ethereum-first-dapp-part-1/"; 
};

(function() { 
    var d = document, s = d.createElement('script');
    s.src = '//vincentserpoul-tech-corner.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</article>
	</div>
</main>
    <footer id="site-footer">
        <div class="container">
            <a href="https://vincentserpoul.github.io/index.xml" title="Get the RSS feed"><span class="tooltip"><i class="fa fa-rss"></i></span></a>
        </div>
    </footer>

    <script type="text/javascript" src="https://vincentserpoul.github.io/js/fittext.js"></script>
    <script type="text/javascript">
      $(".heading").fitText();
    </script>

    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-81802018-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</body>
</html>